!function(n,c){"use strict";function l(b,a,g){var d=g.baseHref(),k=b[0];return function(b,e,f){var g,h;f=f||{},h=f.expires,g=c.isDefined(f.path)?f.path:d,c.isUndefined(e)&&(h="Thu, 01 Jan 1970 00:00:00 GMT",e=""),c.isString(h)&&(h=new Date(h)),e=encodeURIComponent(b)+"="+encodeURIComponent(e),e=e+(g?";path="+g:"")+(f.domain?";domain="+f.domain:""),e+=h?";expires="+h.toUTCString():"",e+=f.secure?";secure":"",f=e.length+1,4096<f&&a.warn("Cookie '"+b+"' possibly not set or overflowed because it was too large ("+f+" > 4096 bytes)!"),k.cookie=e}}c.module("ngCookies",["ng"]).provider("$cookies",[function(){var b=this.defaults={};this.$get=["$$cookieReader","$$cookieWriter",function(a,g){return{get:function(d){return a()[d]},getObject:function(d){return(d=this.get(d))?c.fromJson(d):d},getAll:function(){return a()},put:function(d,a,m){g(d,a,m?c.extend({},b,m):b)},putObject:function(d,b,a){this.put(d,c.toJson(b),a)},remove:function(a,k){g(a,void 0,k?c.extend({},b,k):b)}}}]}]),c.module("ngCookies").factory("$cookieStore",["$cookies",function(b){return{get:function(a){return b.getObject(a)},put:function(a,c){b.putObject(a,c)},remove:function(a){b.remove(a)}}}]),l.$inject=["$document","$log","$browser"],c.module("ngCookies").provider("$$cookieWriter",function(){this.$get=l})}(window,window.angular);var mod;mod=angular.module("infinite-scroll",[]),mod.directive("infiniteScroll",["$rootScope","$window","$timeout",function(i,n,e){return{link:function(t,l,o){var r,c,f,a;return n=angular.element(n),f=0,null!=o.infiniteScrollDistance&&t.$watch(o.infiniteScrollDistance,function(i){return f=parseInt(i,10)}),a=!0,r=!1,null!=o.infiniteScrollDisabled&&t.$watch(o.infiniteScrollDisabled,function(i){return a=!i,a&&r?(r=!1,c()):void 0}),c=function(){var e,c,u,d;return d=n.height()+n.scrollTop(),e=l.offset().top+l.height(),c=e-d,u=n.height()*f>=c,u&&a?i.$$phase?t.$eval(o.infiniteScroll):t.$apply(o.infiniteScroll):u?r=!0:void 0},n.on("scroll",c),t.$on("$destroy",function(){return n.off("scroll",c)}),e(function(){return o.infiniteScrollImmediateCheck?t.$eval(o.infiniteScrollImmediateCheck)?c():void 0:c()},0)}}}]);var app=angular.module("TestFrontend",["ngMaterial","ngCookies","infinite-scroll"]);app.controller("MainCtrl",function($scope,$mdSidenav,$cookies,Account,Project,Task){function getAccountData(){$scope.loading=!0,Account.fetchAccount($cookies.get("userSessionKey"),function(data){$scope.account=data,$scope.loading=!1})}function getProjects(){$scope.loading=!0,Project.fetchProjects($cookies.get("userSessionKey"),function(data){$scope.projects=data,$scope.loading=!1})}function getTasks(){0!=$scope.project.id?($scope.loading=!0,$scope.content="views/tasks.tpl.html",Task.fetchTasks($cookies.get("userSessionKey"),$scope.project.id,$scope.sizeTask,0,$scope.search,function(data){$scope.tasks=data.tasks,$scope.sizeTask>data.total_count&&($scope.isAllTasks=!0),$scope.countTask=data.total_count,$scope.loading=!1})):$scope.content="views/select_project.tpl.html"}function buildToggler(componentId){return function(){$mdSidenav(componentId).toggle()}}$scope.loading=!0,$scope.stepTask=1,$scope.sizeTask=10,$scope.isAllTasks=!1,$scope.countTask=0,$scope.project={id:0},"string"!=typeof $cookies.get("userSessionKey")?($scope.loading=!0,Account.createNewUser(function(data){$cookies.put("userSessionKey",data.session),getAccountData(),getProjects(),$scope.loading=!1})):($scope.loading=!0,Account.checkSession($cookies.get("userSessionKey"),function(){$scope.loading=!1,getAccountData(),getProjects(),$scope.loading=!1})),$scope.$watch("project.id",function(){$scope.isAllTasks=!1,$scope.sizeTask=10,getTasks()}),$scope.$watch("search",function(){getTasks()}),$scope.$watch("tasks",function(){0!=$scope.project.id&&0==$scope.countTask&&($scope.content="views/tasks_not.tpl.html")}),$scope.addProjectBar=function(){$scope.toggleRight(),$scope.rightBar="views/project_add.tpl.html"},$scope.showTaskBar=function(taskId){$scope.loading=!0,Task.fetchTask($cookies.get("userSessionKey"),taskId,function(data){$scope.task=data,$scope.toggleRight(),$scope.rightBar="views/task.tpl.html",$scope.loading=!1})},$scope.addProject=function(){$scope.loading=!0,Project.createProject($cookies.get("userSessionKey"),$scope.project_title,function(data){getProjects(),$scope.toggleRight(),$scope.loading=!1})},$scope.deleteProject=function(){$scope.loading=!0,Project.deleteProject($cookies.get("userSessionKey"),$scope.project.id,function(data){getProjects(),$scope.loading=!1})},$scope.editProjectBar=function(){$scope.toggleRight(),$scope.project.newTitle=$scope.project.title,$scope.rightBar="views/project_edit.tpl.html"},$scope.editProject=function(){$scope.loading=!0,Project.updateProject($cookies.get("userSessionKey"),$scope.project.id,$scope.project.newTitle,function(data){getProjects(),$scope.toggleRight(),$scope.loading=!1})},$scope.addTaskBar=function(){$scope.newTask=null,$scope.toggleRight(),$scope.rightBar="views/task_add.tpl.html"},$scope.addTask=function(){$scope.loading=!0,Task.createTask($cookies.get("userSessionKey"),$scope.project.id,$scope.newTask.title,$scope.newTask.description,function(){getProjects(),getTasks(),$scope.toggleRight(),$scope.loading=!1})},$scope.editTaskBar=function(){$scope.rightBar="views/task_edit.tpl.html"},$scope.editTask=function(){$scope.loading=!0,Task.updateTask($cookies.get("userSessionKey"),$scope.task.id,$scope.task.title,$scope.task.description,function(){getTasks(),$scope.rightBar="views/task.tpl.html",$scope.loading=!1})},$scope.deleteTask=function(){$scope.loading=!0,Task.deleteTask($cookies.get("userSessionKey"),$scope.task.id,function(){getProjects(),getTasks(),$scope.toggleRight(),$scope.loading=!1})},$scope.compliteTask=function(id){$scope.loading=!0,Task.compliteTask($cookies.get("userSessionKey"),id,function(){getProjects(),getTasks(),$scope.loading=!1})},$scope.loadMoreTasks=function(){},$scope.openMenu=function($mdOpenMenu,ev){originatorEv=ev,$mdOpenMenu(ev)},$scope.toggleRight=buildToggler("right")}),app.service("Account",function($http,$log){this.createNewUser=function(callback){$http({method:"POST",url:"https://api-test-task.decodeapps.io/signup"}).then(function(response){callback(response.data)},function(){$log.error("API createNewUser error")})},this.checkSession=function(session,callback){$http({method:"GET",url:"https://api-test-task.decodeapps.io/session",params:{session:session}}).then(function(response){callback(response)},function(){$log.error("API checkSession error")})},this.fetchAccount=function(session,callback){$http({method:"GET",url:"https://api-test-task.decodeapps.io/account",params:{session:session}}).then(function(response){callback(response.data.Account)},function(){$log.error("API fetchAccount error")})}}),app.service("Project",function($http,$log){this.fetchProjects=function(session,callback){$http({method:"GET",url:"https://api-test-task.decodeapps.io/projects",params:{session:session}}).then(function(response){callback(response.data.projects)},function(){$log.error("API fetchProjects error")})},this.fetchProject=function(session,project_id,callback){$http({method:"GET",url:"https://api-test-task.decodeapps.io/projects/project",params:{session:session,project_id:project_id}}).then(function(response){callback(response)},function(){$log.error("API fetchProject error")})},this.createProject=function(session,title,callback){$http({method:"POST",url:"https://api-test-task.decodeapps.io/projects/project",data:{session:session,Project:{title:title}}}).then(function(response){callback(response.data.Account)},function(){$log.error("API createProject error")})},this.updateProject=function(session,id,title,callback){$http({method:"POST",url:"https://api-test-task.decodeapps.io/projects/project",data:{session:session,Project:{id:id,title:title}}}).then(function(response){callback(response.data.Account)},function(){$log.error("API updateProject error")})},this.deleteProject=function(session,id,callback){$http({method:"DELETE",url:"https://api-test-task.decodeapps.io/projects/project",params:{session:session,project_id:id}}).then(function(response){callback(response.data.Account)},function(){$log.error("API deleteProject error")})}}),app.directive("projectsList",function(){return{restrict:"AE",templateUrl:"views/projects.tpl.html"}}),app.service("Task",function($http,$log,$filter){this.fetchTasks=function(session,project_id,paging_size,paging_offset,condition_keywords,callback){$http({method:"GET",url:"https://api-test-task.decodeapps.io/tasks",params:{session:session,project_id:project_id,paging_size:paging_size,paging_offset:paging_offset,condition_keywords:condition_keywords}}).then(function(response){var date,rObj={},tomorrow=new Date;tomorrow.setDate(tomorrow.getDate()-1),response.data.tasks.forEach(function(item){var taskDate=new Date(item.Task.created_at);item.Task.date=$filter("date")(taskDate,"EEEE")+" ("+$filter("date")(taskDate,"dd.MM.yyyy")+")",$filter("date")(new Date,"dd.MM.yyyy")==$filter("date")(taskDate,"dd.MM.yyyy")?item.Task.date="Today":$filter("date")(tomorrow,"dd.MM.yyyy")==$filter("date")(taskDate,"dd.MM.yyyy")&&(item.Task.date="Yesterday"),null!=item.Task.title&&(item.Task.date==date?rObj[date].push(item.Task):(date=item.Task.date,rObj[date]=[item.Task]))}),callback({tasks:rObj,total_count:response.data.total_count})},function(){$log.error("API fetchTasks error")})},this.fetchTask=function(session,task_id,callback){$http({method:"GET",url:"https://api-test-task.decodeapps.io/tasks/task",params:{session:session,task_id:task_id}}).then(function(response){callback(response.data.Task)},function(){$log.error("API fetchProject error")})},this.createTask=function(session,project_id,title,description,callback){$http({method:"POST",url:"https://api-test-task.decodeapps.io/tasks/task",data:{session:session,Project:{id:project_id},Task:{title:title,description:description}}}).then(function(response){callback(response.data.Task)},function(){$log.error("API createTask error")})},this.updateTask=function(session,id,title,description,callback){$http({method:"POST",url:"https://api-test-task.decodeapps.io/tasks/task",data:{session:session,Task:{id:id,title:title,description:description}}}).then(function(response){callback(response.data)},function(){$log.error("API updateTask error")})},this.deleteTask=function(session,id,callback){$http({method:"DELETE",url:"https://api-test-task.decodeapps.io/tasks/task",params:{session:session,task_id:id}}).then(function(response){callback(response.data)},function(){$log.error("API deleteTask error")})},this.compliteTask=function(session,id,callback){$http({method:"POST",url:"https://api-test-task.decodeapps.io/tasks/task",data:{session:session,Task:{id:id}}}).then(function(response){callback(response.data)},function(){$log.error("API deleteTask error")})}});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiXSwibmFtZXMiOlsibiIsImMiLCJsIiwiYiIsImEiLCJnIiwiZCIsImJhc2VIcmVmIiwiayIsImUiLCJmIiwiaCIsImV4cGlyZXMiLCJpc0RlZmluZWQiLCJwYXRoIiwiaXNVbmRlZmluZWQiLCJpc1N0cmluZyIsIkRhdGUiLCJlbmNvZGVVUklDb21wb25lbnQiLCJkb21haW4iLCJ0b1VUQ1N0cmluZyIsInNlY3VyZSIsImxlbmd0aCIsIndhcm4iLCJjb29raWUiLCJtb2R1bGUiLCJwcm92aWRlciIsInRoaXMiLCJkZWZhdWx0cyIsIiRnZXQiLCJnZXQiLCJnZXRPYmplY3QiLCJmcm9tSnNvbiIsImdldEFsbCIsInB1dCIsIm0iLCJleHRlbmQiLCJwdXRPYmplY3QiLCJ0b0pzb24iLCJyZW1vdmUiLCJmYWN0b3J5IiwiJGluamVjdCIsIndpbmRvdyIsImFuZ3VsYXIiLCJtb2QiLCJkaXJlY3RpdmUiLCJpIiwibGluayIsInQiLCJvIiwiciIsImVsZW1lbnQiLCJpbmZpbml0ZVNjcm9sbERpc3RhbmNlIiwiJHdhdGNoIiwicGFyc2VJbnQiLCJpbmZpbml0ZVNjcm9sbERpc2FibGVkIiwidSIsImhlaWdodCIsInNjcm9sbFRvcCIsIm9mZnNldCIsInRvcCIsIiQkcGhhc2UiLCIkZXZhbCIsImluZmluaXRlU2Nyb2xsIiwiJGFwcGx5Iiwib24iLCIkb24iLCJvZmYiLCJpbmZpbml0ZVNjcm9sbEltbWVkaWF0ZUNoZWNrIiwiYXBwIiwiY29udHJvbGxlciIsIiRzY29wZSIsIiRtZFNpZGVuYXYiLCIkY29va2llcyIsIkFjY291bnQiLCJQcm9qZWN0IiwiVGFzayIsImdldEFjY291bnREYXRhIiwibG9hZGluZyIsImZldGNoQWNjb3VudCIsImRhdGEiLCJhY2NvdW50IiwiZ2V0UHJvamVjdHMiLCJmZXRjaFByb2plY3RzIiwicHJvamVjdHMiLCJnZXRUYXNrcyIsInByb2plY3QiLCJpZCIsImNvbnRlbnQiLCJmZXRjaFRhc2tzIiwic2l6ZVRhc2siLCJzZWFyY2giLCJ0YXNrcyIsInRvdGFsX2NvdW50IiwiaXNBbGxUYXNrcyIsImNvdW50VGFzayIsImJ1aWxkVG9nZ2xlciIsImNvbXBvbmVudElkIiwidG9nZ2xlIiwic3RlcFRhc2siLCJjcmVhdGVOZXdVc2VyIiwic2Vzc2lvbiIsImNoZWNrU2Vzc2lvbiIsImFkZFByb2plY3RCYXIiLCJ0b2dnbGVSaWdodCIsInJpZ2h0QmFyIiwic2hvd1Rhc2tCYXIiLCJ0YXNrSWQiLCJmZXRjaFRhc2siLCJ0YXNrIiwiYWRkUHJvamVjdCIsImNyZWF0ZVByb2plY3QiLCJwcm9qZWN0X3RpdGxlIiwiZGVsZXRlUHJvamVjdCIsImVkaXRQcm9qZWN0QmFyIiwibmV3VGl0bGUiLCJ0aXRsZSIsImVkaXRQcm9qZWN0IiwidXBkYXRlUHJvamVjdCIsImFkZFRhc2tCYXIiLCJuZXdUYXNrIiwiYWRkVGFzayIsImNyZWF0ZVRhc2siLCJkZXNjcmlwdGlvbiIsImVkaXRUYXNrQmFyIiwiZWRpdFRhc2siLCJ1cGRhdGVUYXNrIiwiZGVsZXRlVGFzayIsImNvbXBsaXRlVGFzayIsImxvYWRNb3JlVGFza3MiLCJvcGVuTWVudSIsIiRtZE9wZW5NZW51IiwiZXYiLCJvcmlnaW5hdG9yRXYiLCJzZXJ2aWNlIiwiJGh0dHAiLCIkbG9nIiwiY2FsbGJhY2siLCJtZXRob2QiLCJ1cmwiLCJ0aGVuIiwicmVzcG9uc2UiLCJlcnJvciIsInBhcmFtcyIsImZldGNoUHJvamVjdCIsInByb2plY3RfaWQiLCJyZXN0cmljdCIsInRlbXBsYXRlVXJsIiwiJGZpbHRlciIsInBhZ2luZ19zaXplIiwicGFnaW5nX29mZnNldCIsImNvbmRpdGlvbl9rZXl3b3JkcyIsImRhdGUiLCJyT2JqIiwidG9tb3Jyb3ciLCJzZXREYXRlIiwiZ2V0RGF0ZSIsImZvckVhY2giLCJpdGVtIiwidGFza0RhdGUiLCJjcmVhdGVkX2F0IiwicHVzaCIsInRhc2tfaWQiXSwibWFwcGluZ3MiOiJDQVNBLFNBQVVBLEVBQUVDLEdBQUcsWUFBYSxTQUFTQyxHQUFFQyxFQUFFQyxFQUFFQyxHQUFHLEdBQUlDLEdBQUVELEVBQUVFLFdBQVdDLEVBQUVMLEVBQUUsRUFBRyxPQUFPLFVBQVNBLEVBQUVNLEVBQUVDLEdBQUcsR0FBSUwsR0FBRU0sQ0FBRUQsR0FBRUEsTUFBTUMsRUFBRUQsRUFBRUUsUUFBUVAsRUFBRUosRUFBRVksVUFBVUgsRUFBRUksTUFBTUosRUFBRUksS0FBS1IsRUFBRUwsRUFBRWMsWUFBWU4sS0FBS0UsRUFBRSxnQ0FBZ0NGLEVBQUUsSUFBSVIsRUFBRWUsU0FBU0wsS0FBS0EsRUFBRSxHQUFJTSxNQUFLTixJQUFJRixFQUFFUyxtQkFBbUJmLEdBQUcsSUFBSWUsbUJBQW1CVCxHQUFHQSxFQUFFQSxHQUFHSixFQUFFLFNBQVNBLEVBQUUsS0FBS0ssRUFBRVMsT0FBTyxXQUFXVCxFQUFFUyxPQUFPLElBQUlWLEdBQUdFLEVBQUUsWUFBWUEsRUFBRVMsY0FBYyxHQUFHWCxHQUFHQyxFQUFFVyxPQUFPLFVBQVUsR0FBR1gsRUFBRUQsRUFBRWEsT0FBTyxFQUFFLEtBQUtaLEdBQUdOLEVBQUVtQixLQUFLLFdBQVdwQixFQUFFLDhEQUNwY08sRUFBRSxtQkFBbUJGLEVBQUVnQixPQUFPZixHQUFHUixFQUFFd0IsT0FBTyxhQUFhLE9BQU9DLFNBQVMsWUFBWSxXQUFXLEdBQUl2QixHQUFFd0IsS0FBS0MsV0FBWUQsTUFBS0UsTUFBTSxpQkFBaUIsaUJBQWlCLFNBQVN6QixFQUFFQyxHQUFHLE9BQU95QixJQUFJLFNBQVN4QixHQUFHLE1BQU9GLEtBQUlFLElBQUl5QixVQUFVLFNBQVN6QixHQUFHLE9BQU9BLEVBQUVxQixLQUFLRyxJQUFJeEIsSUFBSUwsRUFBRStCLFNBQVMxQixHQUFHQSxHQUFHMkIsT0FBTyxXQUFXLE1BQU83QixNQUFLOEIsSUFBSSxTQUFTNUIsRUFBRUYsRUFBRStCLEdBQUc5QixFQUFFQyxFQUFFRixFQUFFK0IsRUFBRWxDLEVBQUVtQyxVQUFVakMsRUFBRWdDLEdBQUdoQyxJQUFJa0MsVUFBVSxTQUFTL0IsRUFBRUgsRUFBRUMsR0FBR3VCLEtBQUtPLElBQUk1QixFQUFFTCxFQUFFcUMsT0FBT25DLEdBQUdDLElBQUltQyxPQUFPLFNBQVNuQyxFQUFFSSxHQUFHSCxFQUFFRCxFQUFFLE9BQU9JLEVBQUVQLEVBQUVtQyxVQUFVakMsRUFBRUssR0FBR0wsVUFBVUYsRUFBRXdCLE9BQU8sYUFBYWUsUUFBUSxnQkFDamYsV0FBVyxTQUFTckMsR0FBRyxPQUFPMkIsSUFBSSxTQUFTMUIsR0FBRyxNQUFPRCxHQUFFNEIsVUFBVTNCLElBQUk4QixJQUFJLFNBQVM5QixFQUFFSCxHQUFHRSxFQUFFa0MsVUFBVWpDLEVBQUVILElBQUlzQyxPQUFPLFNBQVNuQyxHQUFHRCxFQUFFb0MsT0FBT25DLFFBQVFGLEVBQUV1QyxTQUFTLFlBQVksT0FBTyxZQUFZeEMsRUFBRXdCLE9BQU8sYUFBYUMsU0FBUyxpQkFBaUIsV0FBV0MsS0FBS0UsS0FBSzNCLEtBQU13QyxPQUFPQSxPQUFPQyxRQUdqUixJQUFJQyxJQUFJQSxLQUFJRCxRQUFRbEIsT0FBTyxzQkFBc0JtQixJQUFJQyxVQUFVLGtCQUFrQixhQUFhLFVBQVUsV0FBVyxTQUFTQyxFQUFFOUMsRUFBRVMsR0FBRyxPQUFPc0MsS0FBSyxTQUFTQyxFQUFFOUMsRUFBRStDLEdBQUcsR0FBSUMsR0FBRWpELEVBQUVTLEVBQUVOLENBQUUsT0FBT0osR0FBRTJDLFFBQVFRLFFBQVFuRCxHQUFHVSxFQUFFLEVBQUUsTUFBTXVDLEVBQUVHLHdCQUF3QkosRUFBRUssT0FBT0osRUFBRUcsdUJBQXVCLFNBQVNOLEdBQUcsTUFBT3BDLEdBQUU0QyxTQUFTUixFQUFFLE1BQU0xQyxHQUFFLEVBQUc4QyxHQUFFLEVBQUcsTUFBTUQsRUFBRU0sd0JBQXdCUCxFQUFFSyxPQUFPSixFQUFFTSx1QkFBdUIsU0FBU1QsR0FBRyxNQUFPMUMsSUFBRzBDLEVBQUUxQyxHQUFHOEMsR0FBR0EsR0FBRSxFQUFHakQsS0FBSyxTQUFTQSxFQUFFLFdBQVcsR0FBSVEsR0FBRVIsRUFBRXVELEVBQUVsRCxDQUFFLE9BQU9BLEdBQUVOLEVBQUV5RCxTQUFTekQsRUFBRTBELFlBQVlqRCxFQUFFUCxFQUFFeUQsU0FBU0MsSUFBSTFELEVBQUV1RCxTQUFTeEQsRUFBRVEsRUFBRUgsRUFBRWtELEVBQUV4RCxFQUFFeUQsU0FBUy9DLEdBQUdULEVBQUV1RCxHQUFHcEQsRUFBRTBDLEVBQUVlLFFBQVFiLEVBQUVjLE1BQU1iLEVBQUVjLGdCQUFnQmYsRUFBRWdCLE9BQU9mLEVBQUVjLGdCQUFnQlAsRUFBRU4sR0FBRSxFQUFHLFFBQVFsRCxFQUFFaUUsR0FBRyxTQUFTaEUsR0FBRytDLEVBQUVrQixJQUFJLFdBQVcsV0FBVyxNQUFPbEUsR0FBRW1FLElBQUksU0FBU2xFLEtBQUtRLEVBQUUsV0FBVyxNQUFPd0MsR0FBRW1CLDZCQUE2QnBCLEVBQUVjLE1BQU1iLEVBQUVtQiw4QkFBOEJuRSxJQUFJLE9BQU9BLEtBQUssT0FPcnlCLElBQUlvRSxLQUFNMUIsUUFBUWxCLE9BQU8sZ0JBQWlCLGFBQWMsWUFBYSxtQkFFckU0QyxLQUFJQyxXQUFXLFdBQVksU0FBVUMsT0FBUUMsV0FBWUMsU0FBVUMsUUFBU0MsUUFBU0MsTUFzS2pGLFFBQVNDLGtCQUNMTixPQUFPTyxTQUFVLEVBQ2pCSixRQUFRSyxhQUFhTixTQUFTM0MsSUFBSSxrQkFBbUIsU0FBU2tELE1BQzFEVCxPQUFPVSxRQUFVRCxLQUNqQlQsT0FBT08sU0FBVSxJQUl6QixRQUFTSSxlQUNMWCxPQUFPTyxTQUFVLEVBQ2pCSCxRQUFRUSxjQUFjVixTQUFTM0MsSUFBSSxrQkFBbUIsU0FBU2tELE1BQzNEVCxPQUFPYSxTQUFXSixLQUNsQlQsT0FBT08sU0FBVSxJQUl6QixRQUFTTyxZQUNtQixHQUFyQmQsT0FBT2UsUUFBUUMsSUFDZGhCLE9BQU9PLFNBQVUsRUFDakJQLE9BQU9pQixRQUFVLHVCQUNqQlosS0FBS2EsV0FDRGhCLFNBQVMzQyxJQUFJLGtCQUNieUMsT0FBT2UsUUFBUUMsR0FDZmhCLE9BQU9tQixTQUNQLEVBQ0FuQixPQUFPb0IsT0FDUCxTQUFTWCxNQUNMVCxPQUFPcUIsTUFBUVosS0FBS1ksTUFDakJyQixPQUFPbUIsU0FBV1YsS0FBS2EsY0FDdEJ0QixPQUFPdUIsWUFBYSxHQUN4QnZCLE9BQU93QixVQUFZZixLQUFLYSxZQUN4QnRCLE9BQU9PLFNBQVUsS0FJekJQLE9BQU9pQixRQUFVLGdDQUl6QixRQUFTUSxjQUFhQyxhQUNsQixNQUFPLFlBQ0h6QixXQUFXeUIsYUFBYUMsVUE3TWhDM0IsT0FBT08sU0FBVSxFQUNqQlAsT0FBTzRCLFNBQVcsRUFDbEI1QixPQUFPbUIsU0FBVyxHQUNsQm5CLE9BQU91QixZQUFhLEVBQ3BCdkIsT0FBT3dCLFVBQVksRUFDbkJ4QixPQUFPZSxTQUFZQyxHQUFJLEdBRXFCLGdCQUFsQ2QsVUFBUzNDLElBQUksbUJBQ25CeUMsT0FBT08sU0FBVSxFQUNqQkosUUFBUTBCLGNBQWMsU0FBU3BCLE1BQzNCUCxTQUFTdkMsSUFBSSxpQkFBa0I4QyxLQUFLcUIsU0FDcEN4QixpQkFDQUssY0FDQVgsT0FBT08sU0FBVSxNQUdyQlAsT0FBT08sU0FBVSxFQUNqQkosUUFBUTRCLGFBQWE3QixTQUFTM0MsSUFBSSxrQkFBbUIsV0FDakR5QyxPQUFPTyxTQUFVLEVBQ2pCRCxpQkFDQUssY0FDQVgsT0FBT08sU0FBVSxLQUl6QlAsT0FBT2xCLE9BQU8sYUFBYyxXQUN4QmtCLE9BQU91QixZQUFhLEVBQ3BCdkIsT0FBT21CLFNBQVcsR0FDbEJMLGFBR0pkLE9BQU9sQixPQUFPLFNBQVUsV0FDcEJnQyxhQUdKZCxPQUFPbEIsT0FBTyxRQUFTLFdBQ0ssR0FBckJrQixPQUFPZSxRQUFRQyxJQUErQixHQUFwQmhCLE9BQU93QixZQUNoQ3hCLE9BQU9pQixRQUFVLDhCQUl6QmpCLE9BQU9nQyxjQUFnQixXQUNuQmhDLE9BQU9pQyxjQUNQakMsT0FBT2tDLFNBQVcsOEJBR3RCbEMsT0FBT21DLFlBQWMsU0FBU0MsUUFDMUJwQyxPQUFPTyxTQUFVLEVBQ2pCRixLQUFLZ0MsVUFBVW5DLFNBQVMzQyxJQUFJLGtCQUFtQjZFLE9BQVEsU0FBUzNCLE1BQzVEVCxPQUFPc0MsS0FBTzdCLEtBQ2RULE9BQU9pQyxjQUNQakMsT0FBT2tDLFNBQVcsc0JBQ2xCbEMsT0FBT08sU0FBVSxLQUl6QlAsT0FBT3VDLFdBQWEsV0FDaEJ2QyxPQUFPTyxTQUFVLEVBQ2pCSCxRQUFRb0MsY0FBY3RDLFNBQVMzQyxJQUFJLGtCQUFtQnlDLE9BQU95QyxjQUFlLFNBQVNoQyxNQUNqRkUsY0FDQVgsT0FBT2lDLGNBQ1BqQyxPQUFPTyxTQUFVLEtBSXpCUCxPQUFPMEMsY0FBZ0IsV0FDbkIxQyxPQUFPTyxTQUFVLEVBQ2pCSCxRQUFRc0MsY0FBY3hDLFNBQVMzQyxJQUFJLGtCQUFtQnlDLE9BQU9lLFFBQVFDLEdBQUksU0FBU1AsTUFDOUVFLGNBQ0FYLE9BQU9PLFNBQVUsS0FJekJQLE9BQU8yQyxlQUFrQixXQUNyQjNDLE9BQU9pQyxjQUNQakMsT0FBT2UsUUFBUTZCLFNBQVc1QyxPQUFPZSxRQUFROEIsTUFDekM3QyxPQUFPa0MsU0FBVywrQkFHdEJsQyxPQUFPOEMsWUFBYyxXQUNqQjlDLE9BQU9PLFNBQVUsRUFDakJILFFBQVEyQyxjQUFjN0MsU0FBUzNDLElBQUksa0JBQW1CeUMsT0FBT2UsUUFBUUMsR0FBSWhCLE9BQU9lLFFBQVE2QixTQUFVLFNBQVNuQyxNQUN2R0UsY0FDQVgsT0FBT2lDLGNBQ1BqQyxPQUFPTyxTQUFVLEtBSXpCUCxPQUFPZ0QsV0FBYyxXQUNqQmhELE9BQU9pRCxRQUFVLEtBQ2pCakQsT0FBT2lDLGNBQ1BqQyxPQUFPa0MsU0FBVywyQkFHdEJsQyxPQUFPa0QsUUFBVyxXQUNkbEQsT0FBT08sU0FBVSxFQUNqQkYsS0FBSzhDLFdBQ0RqRCxTQUFTM0MsSUFBSSxrQkFDYnlDLE9BQU9lLFFBQVFDLEdBQ2ZoQixPQUFPaUQsUUFBUUosTUFDZjdDLE9BQU9pRCxRQUFRRyxZQUNmLFdBQ0l6QyxjQUNBRyxXQUNBZCxPQUFPaUMsY0FDUGpDLE9BQU9PLFNBQVUsS0FLN0JQLE9BQU9xRCxZQUFjLFdBQ2pCckQsT0FBT2tDLFNBQVcsNEJBR3RCbEMsT0FBT3NELFNBQVcsV0FDZHRELE9BQU9PLFNBQVUsRUFDakJGLEtBQUtrRCxXQUNEckQsU0FBUzNDLElBQUksa0JBQ2J5QyxPQUFPc0MsS0FBS3RCLEdBQ1poQixPQUFPc0MsS0FBS08sTUFDWjdDLE9BQU9zQyxLQUFLYyxZQUNaLFdBQ0l0QyxXQUNBZCxPQUFPa0MsU0FBVyxzQkFDbEJsQyxPQUFPTyxTQUFVLEtBSzdCUCxPQUFPd0QsV0FBYSxXQUNoQnhELE9BQU9PLFNBQVUsRUFDakJGLEtBQUttRCxXQUFXdEQsU0FBUzNDLElBQUksa0JBQW1CeUMsT0FBT3NDLEtBQUt0QixHQUFJLFdBQzVETCxjQUNBRyxXQUNBZCxPQUFPaUMsY0FDUGpDLE9BQU9PLFNBQVUsS0FJekJQLE9BQU95RCxhQUFlLFNBQVN6QyxJQUMzQmhCLE9BQU9PLFNBQVUsRUFDakJGLEtBQUtvRCxhQUFhdkQsU0FBUzNDLElBQUksa0JBQW1CeUQsR0FBSSxXQUNsREwsY0FDQUcsV0FDQWQsT0FBT08sU0FBVSxLQUl6QlAsT0FBTzBELGNBQWdCLGFBU3ZCMUQsT0FBTzJELFNBQVcsU0FBU0MsWUFBYUMsSUFDcENDLGFBQWVELEdBQ2ZELFlBQVlDLEtBR2hCN0QsT0FBT2lDLFlBQWNSLGFBQWEsV0ErQ3RDM0IsSUFBSWlFLFFBQVEsVUFBVyxTQUFTQyxNQUFPQyxNQUVuQzdHLEtBQUt5RSxjQUFnQixTQUFTcUMsVUFDMUJGLE9BQ0lHLE9BQVEsT0FDUkMsSUFBSywrQ0FDTkMsS0FBSyxTQUF5QkMsVUFDN0JKLFNBQVNJLFNBQVM3RCxPQUNuQixXQUNDd0QsS0FBS00sTUFBTSw4QkFJbkJuSCxLQUFLMkUsYUFBZSxTQUFVRCxRQUFTb0MsVUFDbkNGLE9BQ0lHLE9BQVEsTUFDUkMsSUFBSyw4Q0FDTEksUUFBUzFDLFFBQVNBLFdBQ25CdUMsS0FBSyxTQUF5QkMsVUFDN0JKLFNBQVNJLFdBQ1YsV0FDQ0wsS0FBS00sTUFBTSw2QkFJbkJuSCxLQUFLb0QsYUFBZSxTQUFTc0IsUUFBU29DLFVBQ2xDRixPQUNJRyxPQUFRLE1BQ1JDLElBQUssOENBQ0xJLFFBQVMxQyxRQUFTQSxXQUNuQnVDLEtBQUssU0FBeUJDLFVBQzdCSixTQUFTSSxTQUFTN0QsS0FBS04sVUFDeEIsV0FDQzhELEtBQUtNLE1BQU0sK0JBSXZCekUsSUFBSWlFLFFBQVEsVUFBVyxTQUFTQyxNQUFPQyxNQUVuQzdHLEtBQUt3RCxjQUFnQixTQUFTa0IsUUFBU29DLFVBQ25DRixPQUNJRyxPQUFRLE1BQ1JDLElBQUssK0NBQ0xJLFFBQVMxQyxRQUFTQSxXQUNuQnVDLEtBQUssU0FBeUJDLFVBQzdCSixTQUFTSSxTQUFTN0QsS0FBS0ksV0FDeEIsV0FDQ29ELEtBQUtNLE1BQU0sOEJBSW5CbkgsS0FBS3FILGFBQWUsU0FBVTNDLFFBQVU0QyxXQUFZUixVQUNoREYsT0FDSUcsT0FBUSxNQUNSQyxJQUFLLHVEQUNMSSxRQUFTMUMsUUFBU0EsUUFBUzRDLFdBQVlBLGNBQ3hDTCxLQUFLLFNBQXlCQyxVQUM3QkosU0FBU0ksV0FDVixXQUNDTCxLQUFLTSxNQUFNLDZCQUluQm5ILEtBQUtvRixjQUFnQixTQUFTVixRQUFTZSxNQUFPcUIsVUFDMUNGLE9BQ0lHLE9BQVEsT0FDUkMsSUFBSyx1REFDTDNELE1BQU9xQixRQUFTQSxRQUFTMUIsU0FBV3lDLE1BQU9BLFVBQzVDd0IsS0FBSyxTQUF5QkMsVUFDN0JKLFNBQVNJLFNBQVM3RCxLQUFLTixVQUN4QixXQUNDOEQsS0FBS00sTUFBTSw4QkFJbkJuSCxLQUFLMkYsY0FBZ0IsU0FBU2pCLFFBQVNkLEdBQUk2QixNQUFPcUIsVUFDOUNGLE9BQ0lHLE9BQVEsT0FDUkMsSUFBSyx1REFDTDNELE1BQU9xQixRQUFTQSxRQUFTMUIsU0FBV1ksR0FBSUEsR0FBSTZCLE1BQU9BLFVBQ3BEd0IsS0FBSyxTQUF5QkMsVUFDN0JKLFNBQVNJLFNBQVM3RCxLQUFLTixVQUN4QixXQUNDOEQsS0FBS00sTUFBTSw4QkFJbkJuSCxLQUFLc0YsY0FBZ0IsU0FBU1osUUFBU2QsR0FBSWtELFVBQ3ZDRixPQUNJRyxPQUFRLFNBQ1JDLElBQUssdURBQ0xJLFFBQVMxQyxRQUFTQSxRQUFTNEMsV0FBWTFELE1BQ3hDcUQsS0FBSyxTQUF5QkMsVUFDN0JKLFNBQVNJLFNBQVM3RCxLQUFLTixVQUN4QixXQUNDOEQsS0FBS00sTUFBTSxnQ0FJdkJ6RSxJQUFJeEIsVUFBVSxlQUFnQixXQUMxQixPQUNJcUcsU0FBVSxLQUNWQyxZQUFhLDZCQUdyQjlFLElBQUlpRSxRQUFRLE9BQVEsU0FBU0MsTUFBT0MsS0FBTVksU0FFdEN6SCxLQUFLOEQsV0FBYSxTQUFTWSxRQUFTNEMsV0FBWUksWUFBYUMsY0FBZUMsbUJBQW9CZCxVQUM1RkYsT0FDSUcsT0FBUSxNQUNSQyxJQUFLLDRDQUNMSSxRQUFTMUMsUUFBU0EsUUFBUzRDLFdBQVlBLFdBQVlJLFlBQWFBLFlBQWFDLGNBQWVBLGNBQWVDLG1CQUFvQkEsc0JBQ2hJWCxLQUFLLFNBQXlCQyxVQUM3QixHQUFJVyxNQUNBQyxRQUNBQyxTQUFXLEdBQUl6SSxLQUNuQnlJLFVBQVNDLFFBQVFELFNBQVNFLFVBQVksR0FFdENmLFNBQVM3RCxLQUFLWSxNQUFNaUUsUUFBUSxTQUFTQyxNQUNqQyxHQUFJQyxVQUFXLEdBQUk5SSxNQUFLNkksS0FBS2xGLEtBQUtvRixXQUVsQ0YsTUFBS2xGLEtBQUs0RSxLQUFPSixRQUFRLFFBQVFXLFNBQVUsUUFBVSxLQUFPWCxRQUFRLFFBQVFXLFNBQVUsY0FBZ0IsSUFFbkdYLFFBQVEsUUFBUSxHQUFJbkksTUFBUSxlQUFpQm1JLFFBQVEsUUFBUVcsU0FBVSxjQUN0RUQsS0FBS2xGLEtBQUs0RSxLQUFPLFFBQ2JKLFFBQVEsUUFBUU0sU0FBVSxlQUFpQk4sUUFBUSxRQUFRVyxTQUFVLGdCQUN6RUQsS0FBS2xGLEtBQUs0RSxLQUFPLGFBRUMsTUFBbkJNLEtBQUtsRixLQUFLd0MsUUFDTjBDLEtBQUtsRixLQUFLNEUsTUFBUUEsS0FDakJDLEtBQUtELE1BQU1TLEtBQUtILEtBQUtsRixPQUVyQjRFLEtBQU9NLEtBQUtsRixLQUFLNEUsS0FDakJDLEtBQUtELE9BQVNNLEtBQUtsRixVQUkvQjZELFVBQ0k3QyxNQUFPNkQsS0FDUDVELFlBQWFnRCxTQUFTN0QsS0FBS2EsZUFFaEMsV0FDQzJDLEtBQUtNLE1BQU0sMkJBSW5CbkgsS0FBS2lGLFVBQVksU0FBVVAsUUFBVTZELFFBQVN6QixVQUMxQ0YsT0FDSUcsT0FBUSxNQUNSQyxJQUFLLGlEQUNMSSxRQUFTMUMsUUFBU0EsUUFBUzZELFFBQVNBLFdBQ3JDdEIsS0FBSyxTQUF5QkMsVUFDN0JKLFNBQVNJLFNBQVM3RCxLQUFLSixPQUN4QixXQUNDNEQsS0FBS00sTUFBTSw2QkFJbkJuSCxLQUFLK0YsV0FBYSxTQUFTckIsUUFBUzRDLFdBQVk3QixNQUFPTyxZQUFhYyxVQUNoRUYsT0FDSUcsT0FBUSxPQUNSQyxJQUFLLGlEQUNMM0QsTUFBT3FCLFFBQVNBLFFBQVMxQixTQUFVWSxHQUFJMEQsWUFBYXJFLE1BQU93QyxNQUFPQSxNQUFPTyxZQUFhQSxnQkFDdkZpQixLQUFLLFNBQXlCQyxVQUM3QkosU0FBU0ksU0FBUzdELEtBQUtKLE9BQ3hCLFdBQ0M0RCxLQUFLTSxNQUFNLDJCQUluQm5ILEtBQUttRyxXQUFhLFNBQVN6QixRQUFTZCxHQUFJNkIsTUFBT08sWUFBYWMsVUFDeERGLE9BQ0lHLE9BQVEsT0FDUkMsSUFBSyxpREFDTDNELE1BQU9xQixRQUFTQSxRQUFTekIsTUFBT1csR0FBSUEsR0FBSTZCLE1BQU9BLE1BQU9PLFlBQWFBLGdCQUNwRWlCLEtBQUssU0FBeUJDLFVBQzdCSixTQUFTSSxTQUFTN0QsT0FDbkIsV0FDQ3dELEtBQUtNLE1BQU0sMkJBSW5CbkgsS0FBS29HLFdBQWEsU0FBUzFCLFFBQVNkLEdBQUlrRCxVQUNwQ0YsT0FDSUcsT0FBUSxTQUNSQyxJQUFLLGlEQUNMSSxRQUFTMUMsUUFBU0EsUUFBUzZELFFBQVMzRSxNQUNyQ3FELEtBQUssU0FBeUJDLFVBQzdCSixTQUFTSSxTQUFTN0QsT0FDbkIsV0FDQ3dELEtBQUtNLE1BQU0sMkJBSW5CbkgsS0FBS3FHLGFBQWUsU0FBUzNCLFFBQVNkLEdBQUlrRCxVQUN0Q0YsT0FDSUcsT0FBUSxPQUNSQyxJQUFLLGlEQUNMM0QsTUFBT3FCLFFBQVNBLFFBQVN6QixNQUFPVyxHQUFJQSxPQUNyQ3FELEtBQUssU0FBeUJDLFVBQzdCSixTQUFTSSxTQUFTN0QsT0FDbkIsV0FDQ3dELEtBQUtNLE1BQU0iLCJmaWxlIjoibWFpbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogQ3JlYXRlZCBieSBKZXhpbSBvbiAxOS4xMC4xNi5cbiAqL1xuXG4vKlxuIEFuZ3VsYXJKUyB2MS41LjhcbiAoYykgMjAxMC0yMDE2IEdvb2dsZSwgSW5jLiBodHRwOi8vYW5ndWxhcmpzLm9yZ1xuIExpY2Vuc2U6IE1JVFxuKi9cbihmdW5jdGlvbihuLGMpeyd1c2Ugc3RyaWN0JztmdW5jdGlvbiBsKGIsYSxnKXt2YXIgZD1nLmJhc2VIcmVmKCksaz1iWzBdO3JldHVybiBmdW5jdGlvbihiLGUsZil7dmFyIGcsaDtmPWZ8fHt9O2g9Zi5leHBpcmVzO2c9Yy5pc0RlZmluZWQoZi5wYXRoKT9mLnBhdGg6ZDtjLmlzVW5kZWZpbmVkKGUpJiYoaD1cIlRodSwgMDEgSmFuIDE5NzAgMDA6MDA6MDAgR01UXCIsZT1cIlwiKTtjLmlzU3RyaW5nKGgpJiYoaD1uZXcgRGF0ZShoKSk7ZT1lbmNvZGVVUklDb21wb25lbnQoYikrXCI9XCIrZW5jb2RlVVJJQ29tcG9uZW50KGUpO2U9ZSsoZz9cIjtwYXRoPVwiK2c6XCJcIikrKGYuZG9tYWluP1wiO2RvbWFpbj1cIitmLmRvbWFpbjpcIlwiKTtlKz1oP1wiO2V4cGlyZXM9XCIraC50b1VUQ1N0cmluZygpOlwiXCI7ZSs9Zi5zZWN1cmU/XCI7c2VjdXJlXCI6XCJcIjtmPWUubGVuZ3RoKzE7NDA5NjxmJiZhLndhcm4oXCJDb29raWUgJ1wiK2IrXCInIHBvc3NpYmx5IG5vdCBzZXQgb3Igb3ZlcmZsb3dlZCBiZWNhdXNlIGl0IHdhcyB0b28gbGFyZ2UgKFwiK1xuZitcIiA+IDQwOTYgYnl0ZXMpIVwiKTtrLmNvb2tpZT1lfX1jLm1vZHVsZShcIm5nQ29va2llc1wiLFtcIm5nXCJdKS5wcm92aWRlcihcIiRjb29raWVzXCIsW2Z1bmN0aW9uKCl7dmFyIGI9dGhpcy5kZWZhdWx0cz17fTt0aGlzLiRnZXQ9W1wiJCRjb29raWVSZWFkZXJcIixcIiQkY29va2llV3JpdGVyXCIsZnVuY3Rpb24oYSxnKXtyZXR1cm57Z2V0OmZ1bmN0aW9uKGQpe3JldHVybiBhKClbZF19LGdldE9iamVjdDpmdW5jdGlvbihkKXtyZXR1cm4oZD10aGlzLmdldChkKSk/Yy5mcm9tSnNvbihkKTpkfSxnZXRBbGw6ZnVuY3Rpb24oKXtyZXR1cm4gYSgpfSxwdXQ6ZnVuY3Rpb24oZCxhLG0pe2coZCxhLG0/Yy5leHRlbmQoe30sYixtKTpiKX0scHV0T2JqZWN0OmZ1bmN0aW9uKGQsYixhKXt0aGlzLnB1dChkLGMudG9Kc29uKGIpLGEpfSxyZW1vdmU6ZnVuY3Rpb24oYSxrKXtnKGEsdm9pZCAwLGs/Yy5leHRlbmQoe30sYixrKTpiKX19fV19XSk7Yy5tb2R1bGUoXCJuZ0Nvb2tpZXNcIikuZmFjdG9yeShcIiRjb29raWVTdG9yZVwiLFxuW1wiJGNvb2tpZXNcIixmdW5jdGlvbihiKXtyZXR1cm57Z2V0OmZ1bmN0aW9uKGEpe3JldHVybiBiLmdldE9iamVjdChhKX0scHV0OmZ1bmN0aW9uKGEsYyl7Yi5wdXRPYmplY3QoYSxjKX0scmVtb3ZlOmZ1bmN0aW9uKGEpe2IucmVtb3ZlKGEpfX19XSk7bC4kaW5qZWN0PVtcIiRkb2N1bWVudFwiLFwiJGxvZ1wiLFwiJGJyb3dzZXJcIl07Yy5tb2R1bGUoXCJuZ0Nvb2tpZXNcIikucHJvdmlkZXIoXCIkJGNvb2tpZVdyaXRlclwiLGZ1bmN0aW9uKCl7dGhpcy4kZ2V0PWx9KX0pKHdpbmRvdyx3aW5kb3cuYW5ndWxhcik7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1hbmd1bGFyLWNvb2tpZXMubWluLmpzLm1hcFxuLyogbmctaW5maW5pdGUtc2Nyb2xsIC0gdjEuMC4wIC0gMjAxMy0wMi0yMyAqL1xudmFyIG1vZDttb2Q9YW5ndWxhci5tb2R1bGUoXCJpbmZpbml0ZS1zY3JvbGxcIixbXSksbW9kLmRpcmVjdGl2ZShcImluZmluaXRlU2Nyb2xsXCIsW1wiJHJvb3RTY29wZVwiLFwiJHdpbmRvd1wiLFwiJHRpbWVvdXRcIixmdW5jdGlvbihpLG4sZSl7cmV0dXJue2xpbms6ZnVuY3Rpb24odCxsLG8pe3ZhciByLGMsZixhO3JldHVybiBuPWFuZ3VsYXIuZWxlbWVudChuKSxmPTAsbnVsbCE9by5pbmZpbml0ZVNjcm9sbERpc3RhbmNlJiZ0LiR3YXRjaChvLmluZmluaXRlU2Nyb2xsRGlzdGFuY2UsZnVuY3Rpb24oaSl7cmV0dXJuIGY9cGFyc2VJbnQoaSwxMCl9KSxhPSEwLHI9ITEsbnVsbCE9by5pbmZpbml0ZVNjcm9sbERpc2FibGVkJiZ0LiR3YXRjaChvLmluZmluaXRlU2Nyb2xsRGlzYWJsZWQsZnVuY3Rpb24oaSl7cmV0dXJuIGE9IWksYSYmcj8ocj0hMSxjKCkpOnZvaWQgMH0pLGM9ZnVuY3Rpb24oKXt2YXIgZSxjLHUsZDtyZXR1cm4gZD1uLmhlaWdodCgpK24uc2Nyb2xsVG9wKCksZT1sLm9mZnNldCgpLnRvcCtsLmhlaWdodCgpLGM9ZS1kLHU9bi5oZWlnaHQoKSpmPj1jLHUmJmE/aS4kJHBoYXNlP3QuJGV2YWwoby5pbmZpbml0ZVNjcm9sbCk6dC4kYXBwbHkoby5pbmZpbml0ZVNjcm9sbCk6dT9yPSEwOnZvaWQgMH0sbi5vbihcInNjcm9sbFwiLGMpLHQuJG9uKFwiJGRlc3Ryb3lcIixmdW5jdGlvbigpe3JldHVybiBuLm9mZihcInNjcm9sbFwiLGMpfSksZShmdW5jdGlvbigpe3JldHVybiBvLmluZmluaXRlU2Nyb2xsSW1tZWRpYXRlQ2hlY2s/dC4kZXZhbChvLmluZmluaXRlU2Nyb2xsSW1tZWRpYXRlQ2hlY2spP2MoKTp2b2lkIDA6YygpfSwwKX19fV0pO1xuXG5cbi8qKlxuICogQ3JlYXRlZCBieSBKZXhpbSBvbiAxOS4xMC4xNi5cbiAqL1xuXG52YXIgYXBwID0gYW5ndWxhci5tb2R1bGUoJ1Rlc3RGcm9udGVuZCcsIFsnbmdNYXRlcmlhbCcsICduZ0Nvb2tpZXMnLCAnaW5maW5pdGUtc2Nyb2xsJ10pO1xuXG5hcHAuY29udHJvbGxlcignTWFpbkN0cmwnLCBmdW5jdGlvbiAoJHNjb3BlLCAkbWRTaWRlbmF2LCAkY29va2llcywgQWNjb3VudCwgUHJvamVjdCwgVGFzayl7XG5cbiAgICAkc2NvcGUubG9hZGluZyA9IHRydWU7XG4gICAgJHNjb3BlLnN0ZXBUYXNrID0gMTtcbiAgICAkc2NvcGUuc2l6ZVRhc2sgPSAxMDtcbiAgICAkc2NvcGUuaXNBbGxUYXNrcyA9IGZhbHNlO1xuICAgICRzY29wZS5jb3VudFRhc2sgPSAwO1xuICAgICRzY29wZS5wcm9qZWN0ID0geyBpZDogMCB9O1xuXG4gICAgaWYodHlwZW9mICRjb29raWVzLmdldCgndXNlclNlc3Npb25LZXknKSAhPSAnc3RyaW5nJyl7XG4gICAgICAgICRzY29wZS5sb2FkaW5nID0gdHJ1ZTtcbiAgICAgICAgQWNjb3VudC5jcmVhdGVOZXdVc2VyKGZ1bmN0aW9uKGRhdGEpe1xuICAgICAgICAgICAgJGNvb2tpZXMucHV0KCd1c2VyU2Vzc2lvbktleScsIGRhdGEuc2Vzc2lvbik7XG4gICAgICAgICAgICBnZXRBY2NvdW50RGF0YSgpO1xuICAgICAgICAgICAgZ2V0UHJvamVjdHMoKTtcbiAgICAgICAgICAgICRzY29wZS5sb2FkaW5nID0gZmFsc2U7XG4gICAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICAgICRzY29wZS5sb2FkaW5nID0gdHJ1ZTtcbiAgICAgICAgQWNjb3VudC5jaGVja1Nlc3Npb24oJGNvb2tpZXMuZ2V0KCd1c2VyU2Vzc2lvbktleScpLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICRzY29wZS5sb2FkaW5nID0gZmFsc2U7XG4gICAgICAgICAgICBnZXRBY2NvdW50RGF0YSgpO1xuICAgICAgICAgICAgZ2V0UHJvamVjdHMoKTtcbiAgICAgICAgICAgICRzY29wZS5sb2FkaW5nID0gZmFsc2U7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgICRzY29wZS4kd2F0Y2goJ3Byb2plY3QuaWQnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgJHNjb3BlLmlzQWxsVGFza3MgPSBmYWxzZTtcbiAgICAgICAgJHNjb3BlLnNpemVUYXNrID0gMTA7XG4gICAgICAgIGdldFRhc2tzKCk7XG4gICAgfSk7XG5cbiAgICAkc2NvcGUuJHdhdGNoKCdzZWFyY2gnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgZ2V0VGFza3MoKTtcbiAgICB9KTtcblxuICAgICRzY29wZS4kd2F0Y2goJ3Rhc2tzJywgZnVuY3Rpb24gKCkge1xuICAgICAgICBpZigkc2NvcGUucHJvamVjdC5pZCAhPSAwICYmICRzY29wZS5jb3VudFRhc2sgPT0gMCl7XG4gICAgICAgICAgICAkc2NvcGUuY29udGVudCA9ICd2aWV3cy90YXNrc19ub3QudHBsLmh0bWwnO1xuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICAkc2NvcGUuYWRkUHJvamVjdEJhciA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAkc2NvcGUudG9nZ2xlUmlnaHQoKTtcbiAgICAgICAgJHNjb3BlLnJpZ2h0QmFyID0gJ3ZpZXdzL3Byb2plY3RfYWRkLnRwbC5odG1sJztcbiAgICB9O1xuXG4gICAgJHNjb3BlLnNob3dUYXNrQmFyID0gZnVuY3Rpb24odGFza0lkKSB7XG4gICAgICAgICRzY29wZS5sb2FkaW5nID0gdHJ1ZTtcbiAgICAgICAgVGFzay5mZXRjaFRhc2soJGNvb2tpZXMuZ2V0KCd1c2VyU2Vzc2lvbktleScpLCB0YXNrSWQsIGZ1bmN0aW9uKGRhdGEpe1xuICAgICAgICAgICAgJHNjb3BlLnRhc2sgPSBkYXRhO1xuICAgICAgICAgICAgJHNjb3BlLnRvZ2dsZVJpZ2h0KCk7XG4gICAgICAgICAgICAkc2NvcGUucmlnaHRCYXIgPSAndmlld3MvdGFzay50cGwuaHRtbCc7XG4gICAgICAgICAgICAkc2NvcGUubG9hZGluZyA9IGZhbHNlO1xuICAgICAgICB9KTtcbiAgICB9O1xuXG4gICAgJHNjb3BlLmFkZFByb2plY3QgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgJHNjb3BlLmxvYWRpbmcgPSB0cnVlO1xuICAgICAgICBQcm9qZWN0LmNyZWF0ZVByb2plY3QoJGNvb2tpZXMuZ2V0KCd1c2VyU2Vzc2lvbktleScpLCAkc2NvcGUucHJvamVjdF90aXRsZSwgZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgZ2V0UHJvamVjdHMoKTtcbiAgICAgICAgICAgICRzY29wZS50b2dnbGVSaWdodCgpO1xuICAgICAgICAgICAgJHNjb3BlLmxvYWRpbmcgPSBmYWxzZTtcbiAgICAgICAgfSk7XG4gICAgfTtcblxuICAgICRzY29wZS5kZWxldGVQcm9qZWN0ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICRzY29wZS5sb2FkaW5nID0gdHJ1ZTtcbiAgICAgICAgUHJvamVjdC5kZWxldGVQcm9qZWN0KCRjb29raWVzLmdldCgndXNlclNlc3Npb25LZXknKSwgJHNjb3BlLnByb2plY3QuaWQsIGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgIGdldFByb2plY3RzKCk7XG4gICAgICAgICAgICAkc2NvcGUubG9hZGluZyA9IGZhbHNlO1xuICAgICAgICB9KTtcbiAgICB9O1xuXG4gICAgJHNjb3BlLmVkaXRQcm9qZWN0QmFyICA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAkc2NvcGUudG9nZ2xlUmlnaHQoKTtcbiAgICAgICAgJHNjb3BlLnByb2plY3QubmV3VGl0bGUgPSAkc2NvcGUucHJvamVjdC50aXRsZTtcbiAgICAgICAgJHNjb3BlLnJpZ2h0QmFyID0gJ3ZpZXdzL3Byb2plY3RfZWRpdC50cGwuaHRtbCc7XG4gICAgfTtcblxuICAgICRzY29wZS5lZGl0UHJvamVjdCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAkc2NvcGUubG9hZGluZyA9IHRydWU7XG4gICAgICAgIFByb2plY3QudXBkYXRlUHJvamVjdCgkY29va2llcy5nZXQoJ3VzZXJTZXNzaW9uS2V5JyksICRzY29wZS5wcm9qZWN0LmlkLCAkc2NvcGUucHJvamVjdC5uZXdUaXRsZSwgZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgZ2V0UHJvamVjdHMoKTtcbiAgICAgICAgICAgICRzY29wZS50b2dnbGVSaWdodCgpO1xuICAgICAgICAgICAgJHNjb3BlLmxvYWRpbmcgPSBmYWxzZTtcbiAgICAgICAgfSk7XG4gICAgfTtcblxuICAgICRzY29wZS5hZGRUYXNrQmFyICA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAkc2NvcGUubmV3VGFzayA9IG51bGw7XG4gICAgICAgICRzY29wZS50b2dnbGVSaWdodCgpO1xuICAgICAgICAkc2NvcGUucmlnaHRCYXIgPSAndmlld3MvdGFza19hZGQudHBsLmh0bWwnO1xuICAgIH07XG5cbiAgICAkc2NvcGUuYWRkVGFzayAgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgJHNjb3BlLmxvYWRpbmcgPSB0cnVlO1xuICAgICAgICBUYXNrLmNyZWF0ZVRhc2soXG4gICAgICAgICAgICAkY29va2llcy5nZXQoJ3VzZXJTZXNzaW9uS2V5JyksXG4gICAgICAgICAgICAkc2NvcGUucHJvamVjdC5pZCxcbiAgICAgICAgICAgICRzY29wZS5uZXdUYXNrLnRpdGxlLFxuICAgICAgICAgICAgJHNjb3BlLm5ld1Rhc2suZGVzY3JpcHRpb24sXG4gICAgICAgICAgICBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICBnZXRQcm9qZWN0cygpO1xuICAgICAgICAgICAgICAgIGdldFRhc2tzKCk7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnRvZ2dsZVJpZ2h0KCk7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmxvYWRpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgKTtcbiAgICB9O1xuXG4gICAgJHNjb3BlLmVkaXRUYXNrQmFyID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICRzY29wZS5yaWdodEJhciA9ICd2aWV3cy90YXNrX2VkaXQudHBsLmh0bWwnO1xuICAgIH07XG5cbiAgICAkc2NvcGUuZWRpdFRhc2sgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgJHNjb3BlLmxvYWRpbmcgPSB0cnVlO1xuICAgICAgICBUYXNrLnVwZGF0ZVRhc2soXG4gICAgICAgICAgICAkY29va2llcy5nZXQoJ3VzZXJTZXNzaW9uS2V5JyksXG4gICAgICAgICAgICAkc2NvcGUudGFzay5pZCxcbiAgICAgICAgICAgICRzY29wZS50YXNrLnRpdGxlLFxuICAgICAgICAgICAgJHNjb3BlLnRhc2suZGVzY3JpcHRpb24sXG4gICAgICAgICAgICBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICBnZXRUYXNrcygpO1xuICAgICAgICAgICAgICAgICRzY29wZS5yaWdodEJhciA9ICd2aWV3cy90YXNrLnRwbC5odG1sJztcbiAgICAgICAgICAgICAgICAkc2NvcGUubG9hZGluZyA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICApO1xuICAgIH07XG5cbiAgICAkc2NvcGUuZGVsZXRlVGFzayA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAkc2NvcGUubG9hZGluZyA9IHRydWU7XG4gICAgICAgIFRhc2suZGVsZXRlVGFzaygkY29va2llcy5nZXQoJ3VzZXJTZXNzaW9uS2V5JyksICRzY29wZS50YXNrLmlkLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBnZXRQcm9qZWN0cygpO1xuICAgICAgICAgICAgZ2V0VGFza3MoKTtcbiAgICAgICAgICAgICRzY29wZS50b2dnbGVSaWdodCgpO1xuICAgICAgICAgICAgJHNjb3BlLmxvYWRpbmcgPSBmYWxzZTtcbiAgICAgICAgfSk7XG4gICAgfTtcblxuICAgICRzY29wZS5jb21wbGl0ZVRhc2sgPSBmdW5jdGlvbihpZCkge1xuICAgICAgICAkc2NvcGUubG9hZGluZyA9IHRydWU7XG4gICAgICAgIFRhc2suY29tcGxpdGVUYXNrKCRjb29raWVzLmdldCgndXNlclNlc3Npb25LZXknKSwgaWQsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgZ2V0UHJvamVjdHMoKTtcbiAgICAgICAgICAgIGdldFRhc2tzKCk7XG4gICAgICAgICAgICAkc2NvcGUubG9hZGluZyA9IGZhbHNlO1xuICAgICAgICB9KTtcbiAgICB9O1xuXG4gICAgJHNjb3BlLmxvYWRNb3JlVGFza3MgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIC8vaWYoISRzY29wZS5pc0FsbFRhc2tzKXtcbiAgICAgICAgLy8gICAgJHNjb3BlLnNpemVUYXNrID0gJHNjb3BlLnNpemVUYXNrICsgJHNjb3BlLnN0ZXBUYXNrO1xuICAgICAgICAvLyAgICBpZigkc2NvcGUuc2l6ZVRhc2sgPiAkc2NvcGUuY291bnRUYXNrKVxuICAgICAgICAvLyAgICAgICAgJHNjb3BlLnNpemVUYXNrID0gJHNjb3BlLmNvdW50VGFzaztcbiAgICAgICAgLy8gICAgZ2V0VGFza3MoKTtcbiAgICAgICAgLy99XG4gICAgfTtcblxuICAgICRzY29wZS5vcGVuTWVudSA9IGZ1bmN0aW9uKCRtZE9wZW5NZW51LCBldikge1xuICAgICAgICBvcmlnaW5hdG9yRXYgPSBldjtcbiAgICAgICAgJG1kT3Blbk1lbnUoZXYpO1xuICAgIH07XG5cbiAgICAkc2NvcGUudG9nZ2xlUmlnaHQgPSBidWlsZFRvZ2dsZXIoJ3JpZ2h0Jyk7XG5cbiAgICBmdW5jdGlvbiBnZXRBY2NvdW50RGF0YSgpIHtcbiAgICAgICAgJHNjb3BlLmxvYWRpbmcgPSB0cnVlO1xuICAgICAgICBBY2NvdW50LmZldGNoQWNjb3VudCgkY29va2llcy5nZXQoJ3VzZXJTZXNzaW9uS2V5JyksIGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgICRzY29wZS5hY2NvdW50ID0gZGF0YTtcbiAgICAgICAgICAgICRzY29wZS5sb2FkaW5nID0gZmFsc2U7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGdldFByb2plY3RzKCkge1xuICAgICAgICAkc2NvcGUubG9hZGluZyA9IHRydWU7XG4gICAgICAgIFByb2plY3QuZmV0Y2hQcm9qZWN0cygkY29va2llcy5nZXQoJ3VzZXJTZXNzaW9uS2V5JyksIGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgICRzY29wZS5wcm9qZWN0cyA9IGRhdGE7XG4gICAgICAgICAgICAkc2NvcGUubG9hZGluZyA9IGZhbHNlO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBnZXRUYXNrcygpIHtcbiAgICAgICAgaWYoJHNjb3BlLnByb2plY3QuaWQgIT0gMCl7XG4gICAgICAgICAgICAkc2NvcGUubG9hZGluZyA9IHRydWU7XG4gICAgICAgICAgICAkc2NvcGUuY29udGVudCA9ICd2aWV3cy90YXNrcy50cGwuaHRtbCc7XG4gICAgICAgICAgICBUYXNrLmZldGNoVGFza3MoXG4gICAgICAgICAgICAgICAgJGNvb2tpZXMuZ2V0KCd1c2VyU2Vzc2lvbktleScpLFxuICAgICAgICAgICAgICAgICRzY29wZS5wcm9qZWN0LmlkLFxuICAgICAgICAgICAgICAgICRzY29wZS5zaXplVGFzayxcbiAgICAgICAgICAgICAgICAwLFxuICAgICAgICAgICAgICAgICRzY29wZS5zZWFyY2gsXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUudGFza3MgPSBkYXRhLnRhc2tzO1xuICAgICAgICAgICAgICAgICAgICBpZigkc2NvcGUuc2l6ZVRhc2sgPiBkYXRhLnRvdGFsX2NvdW50KVxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmlzQWxsVGFza3MgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuY291bnRUYXNrID0gZGF0YS50b3RhbF9jb3VudDtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmxvYWRpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICApO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgJHNjb3BlLmNvbnRlbnQgPSAndmlld3Mvc2VsZWN0X3Byb2plY3QudHBsLmh0bWwnO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gYnVpbGRUb2dnbGVyKGNvbXBvbmVudElkKSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICRtZFNpZGVuYXYoY29tcG9uZW50SWQpLnRvZ2dsZSgpO1xuICAgICAgICB9XG4gICAgfVxufSk7XG5hcHAuc2VydmljZSgnQWNjb3VudCcsIGZ1bmN0aW9uKCRodHRwLCAkbG9nKSB7XG5cbiAgICB0aGlzLmNyZWF0ZU5ld1VzZXIgPSBmdW5jdGlvbihjYWxsYmFjaykge1xuICAgICAgICAkaHR0cCh7XG4gICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICAgIHVybDogJ2h0dHBzOi8vYXBpLXRlc3QtdGFzay5kZWNvZGVhcHBzLmlvL3NpZ251cCdcbiAgICAgICAgfSkudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzcG9uc2UpIHtcbiAgICAgICAgICAgIGNhbGxiYWNrKHJlc3BvbnNlLmRhdGEpO1xuICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKCkge1xuICAgICAgICAgICAgJGxvZy5lcnJvcignQVBJIGNyZWF0ZU5ld1VzZXIgZXJyb3InKTtcbiAgICAgICAgfSk7XG4gICAgfSxcblxuICAgIHRoaXMuY2hlY2tTZXNzaW9uID0gZnVuY3Rpb24gKHNlc3Npb24gLGNhbGxiYWNrKSB7XG4gICAgICAgICRodHRwKHtcbiAgICAgICAgICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgICAgICAgICB1cmw6ICdodHRwczovL2FwaS10ZXN0LXRhc2suZGVjb2RlYXBwcy5pby9zZXNzaW9uJyxcbiAgICAgICAgICAgIHBhcmFtczoge3Nlc3Npb246IHNlc3Npb259LFxuICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXNwb25zZSkge1xuICAgICAgICAgICAgY2FsbGJhY2socmVzcG9uc2UpO1xuICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKCkge1xuICAgICAgICAgICAgJGxvZy5lcnJvcignQVBJIGNoZWNrU2Vzc2lvbiBlcnJvcicpO1xuICAgICAgICB9KTtcbiAgICB9LFxuXG4gICAgdGhpcy5mZXRjaEFjY291bnQgPSBmdW5jdGlvbihzZXNzaW9uLCBjYWxsYmFjaykge1xuICAgICAgICAkaHR0cCh7XG4gICAgICAgICAgICBtZXRob2Q6ICdHRVQnLFxuICAgICAgICAgICAgdXJsOiAnaHR0cHM6Ly9hcGktdGVzdC10YXNrLmRlY29kZWFwcHMuaW8vYWNjb3VudCcsXG4gICAgICAgICAgICBwYXJhbXM6IHtzZXNzaW9uOiBzZXNzaW9ufSxcbiAgICAgICAgfSkudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzcG9uc2UpIHtcbiAgICAgICAgICAgIGNhbGxiYWNrKHJlc3BvbnNlLmRhdGEuQWNjb3VudCk7XG4gICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2soKSB7XG4gICAgICAgICAgICAkbG9nLmVycm9yKCdBUEkgZmV0Y2hBY2NvdW50IGVycm9yJyk7XG4gICAgICAgIH0pO1xuICAgIH1cbn0pO1xuYXBwLnNlcnZpY2UoJ1Byb2plY3QnLCBmdW5jdGlvbigkaHR0cCwgJGxvZykge1xuXG4gICAgdGhpcy5mZXRjaFByb2plY3RzID0gZnVuY3Rpb24oc2Vzc2lvbiwgY2FsbGJhY2spIHtcbiAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgbWV0aG9kOiAnR0VUJyxcbiAgICAgICAgICAgIHVybDogJ2h0dHBzOi8vYXBpLXRlc3QtdGFzay5kZWNvZGVhcHBzLmlvL3Byb2plY3RzJyxcbiAgICAgICAgICAgIHBhcmFtczoge3Nlc3Npb246IHNlc3Npb259LFxuICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXNwb25zZSkge1xuICAgICAgICAgICAgY2FsbGJhY2socmVzcG9uc2UuZGF0YS5wcm9qZWN0cyk7XG4gICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2soKSB7XG4gICAgICAgICAgICAkbG9nLmVycm9yKCdBUEkgZmV0Y2hQcm9qZWN0cyBlcnJvcicpO1xuICAgICAgICB9KTtcbiAgICB9O1xuXG4gICAgdGhpcy5mZXRjaFByb2plY3QgPSBmdW5jdGlvbiAoc2Vzc2lvbiAsIHByb2plY3RfaWQsIGNhbGxiYWNrKSB7XG4gICAgICAgICRodHRwKHtcbiAgICAgICAgICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgICAgICAgICB1cmw6ICdodHRwczovL2FwaS10ZXN0LXRhc2suZGVjb2RlYXBwcy5pby9wcm9qZWN0cy9wcm9qZWN0JyxcbiAgICAgICAgICAgIHBhcmFtczoge3Nlc3Npb246IHNlc3Npb24sIHByb2plY3RfaWQ6IHByb2plY3RfaWR9LFxuICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXNwb25zZSkge1xuICAgICAgICAgICAgY2FsbGJhY2socmVzcG9uc2UpO1xuICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKCkge1xuICAgICAgICAgICAgJGxvZy5lcnJvcignQVBJIGZldGNoUHJvamVjdCBlcnJvcicpO1xuICAgICAgICB9KTtcbiAgICB9O1xuXG4gICAgdGhpcy5jcmVhdGVQcm9qZWN0ID0gZnVuY3Rpb24oc2Vzc2lvbiwgdGl0bGUsIGNhbGxiYWNrKSB7XG4gICAgICAgICRodHRwKHtcbiAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgdXJsOiAnaHR0cHM6Ly9hcGktdGVzdC10YXNrLmRlY29kZWFwcHMuaW8vcHJvamVjdHMvcHJvamVjdCcsXG4gICAgICAgICAgICBkYXRhOiB7c2Vzc2lvbjogc2Vzc2lvbiwgUHJvamVjdDogeyB0aXRsZTogdGl0bGUgfX0sXG4gICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICBjYWxsYmFjayhyZXNwb25zZS5kYXRhLkFjY291bnQpO1xuICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKCkge1xuICAgICAgICAgICAgJGxvZy5lcnJvcignQVBJIGNyZWF0ZVByb2plY3QgZXJyb3InKTtcbiAgICAgICAgfSk7XG4gICAgfTtcblxuICAgIHRoaXMudXBkYXRlUHJvamVjdCA9IGZ1bmN0aW9uKHNlc3Npb24sIGlkLCB0aXRsZSwgY2FsbGJhY2spIHtcbiAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgICB1cmw6ICdodHRwczovL2FwaS10ZXN0LXRhc2suZGVjb2RlYXBwcy5pby9wcm9qZWN0cy9wcm9qZWN0JyxcbiAgICAgICAgICAgIGRhdGE6IHtzZXNzaW9uOiBzZXNzaW9uLCBQcm9qZWN0OiB7IGlkOiBpZCwgdGl0bGU6IHRpdGxlIH19LFxuICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXNwb25zZSkge1xuICAgICAgICAgICAgY2FsbGJhY2socmVzcG9uc2UuZGF0YS5BY2NvdW50KTtcbiAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjaygpIHtcbiAgICAgICAgICAgICRsb2cuZXJyb3IoJ0FQSSB1cGRhdGVQcm9qZWN0IGVycm9yJyk7XG4gICAgICAgIH0pO1xuICAgIH07XG5cbiAgICB0aGlzLmRlbGV0ZVByb2plY3QgPSBmdW5jdGlvbihzZXNzaW9uLCBpZCwgY2FsbGJhY2spIHtcbiAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgbWV0aG9kOiAnREVMRVRFJyxcbiAgICAgICAgICAgIHVybDogJ2h0dHBzOi8vYXBpLXRlc3QtdGFzay5kZWNvZGVhcHBzLmlvL3Byb2plY3RzL3Byb2plY3QnLFxuICAgICAgICAgICAgcGFyYW1zOiB7c2Vzc2lvbjogc2Vzc2lvbiwgcHJvamVjdF9pZDogaWR9LFxuICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXNwb25zZSkge1xuICAgICAgICAgICAgY2FsbGJhY2socmVzcG9uc2UuZGF0YS5BY2NvdW50KTtcbiAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjaygpIHtcbiAgICAgICAgICAgICRsb2cuZXJyb3IoJ0FQSSBkZWxldGVQcm9qZWN0IGVycm9yJyk7XG4gICAgICAgIH0pO1xuICAgIH1cbn0pO1xuYXBwLmRpcmVjdGl2ZSgncHJvamVjdHNMaXN0JywgZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgcmVzdHJpY3Q6IFwiQUVcIixcbiAgICAgICAgdGVtcGxhdGVVcmw6IFwidmlld3MvcHJvamVjdHMudHBsLmh0bWxcIlxuICAgIH1cbn0pO1xuYXBwLnNlcnZpY2UoJ1Rhc2snLCBmdW5jdGlvbigkaHR0cCwgJGxvZywgJGZpbHRlcikge1xuXG4gICAgdGhpcy5mZXRjaFRhc2tzID0gZnVuY3Rpb24oc2Vzc2lvbiwgcHJvamVjdF9pZCwgcGFnaW5nX3NpemUsIHBhZ2luZ19vZmZzZXQsIGNvbmRpdGlvbl9rZXl3b3JkcywgY2FsbGJhY2spIHtcbiAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgbWV0aG9kOiAnR0VUJyxcbiAgICAgICAgICAgIHVybDogJ2h0dHBzOi8vYXBpLXRlc3QtdGFzay5kZWNvZGVhcHBzLmlvL3Rhc2tzJyxcbiAgICAgICAgICAgIHBhcmFtczoge3Nlc3Npb246IHNlc3Npb24sIHByb2plY3RfaWQ6IHByb2plY3RfaWQsIHBhZ2luZ19zaXplOiBwYWdpbmdfc2l6ZSwgcGFnaW5nX29mZnNldDogcGFnaW5nX29mZnNldCwgY29uZGl0aW9uX2tleXdvcmRzOiBjb25kaXRpb25fa2V5d29yZHN9LFxuICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXNwb25zZSkge1xuICAgICAgICAgICAgdmFyIGRhdGU7XG4gICAgICAgICAgICB2YXIgck9iaiA9IHt9O1xuICAgICAgICAgICAgdmFyIHRvbW9ycm93ID0gbmV3IERhdGUoKTtcbiAgICAgICAgICAgIHRvbW9ycm93LnNldERhdGUodG9tb3Jyb3cuZ2V0RGF0ZSgpIC0gMSk7XG5cbiAgICAgICAgICAgIHJlc3BvbnNlLmRhdGEudGFza3MuZm9yRWFjaChmdW5jdGlvbihpdGVtKXtcbiAgICAgICAgICAgICAgICB2YXIgdGFza0RhdGUgPSBuZXcgRGF0ZShpdGVtLlRhc2suY3JlYXRlZF9hdCk7XG5cbiAgICAgICAgICAgICAgICBpdGVtLlRhc2suZGF0ZSA9ICRmaWx0ZXIoJ2RhdGUnKSh0YXNrRGF0ZSwgJ0VFRUUnKSArICcgKCcgKyAkZmlsdGVyKCdkYXRlJykodGFza0RhdGUsICdkZC5NTS55eXl5JykgKyAnKSc7XG5cbiAgICAgICAgICAgICAgICBpZigkZmlsdGVyKCdkYXRlJykobmV3IERhdGUoKSwgJ2RkLk1NLnl5eXknKSA9PSAkZmlsdGVyKCdkYXRlJykodGFza0RhdGUsICdkZC5NTS55eXl5JykpXG4gICAgICAgICAgICAgICAgICAgIGl0ZW0uVGFzay5kYXRlID0gXCJUb2RheVwiO1xuICAgICAgICAgICAgICAgIGVsc2UgaWYoJGZpbHRlcignZGF0ZScpKHRvbW9ycm93LCAnZGQuTU0ueXl5eScpID09ICRmaWx0ZXIoJ2RhdGUnKSh0YXNrRGF0ZSwgJ2RkLk1NLnl5eXknKSlcbiAgICAgICAgICAgICAgICAgICAgaXRlbS5UYXNrLmRhdGUgPSBcIlllc3RlcmRheVwiO1xuXG4gICAgICAgICAgICAgICAgaWYoaXRlbS5UYXNrLnRpdGxlICE9IG51bGwpe1xuICAgICAgICAgICAgICAgICAgICBpZihpdGVtLlRhc2suZGF0ZSA9PSBkYXRlKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJPYmpbZGF0ZV0ucHVzaChpdGVtLlRhc2spO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZSA9IGl0ZW0uVGFzay5kYXRlO1xuICAgICAgICAgICAgICAgICAgICAgICAgck9ialtkYXRlXSA9IFtpdGVtLlRhc2tdO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBjYWxsYmFjayh7XG4gICAgICAgICAgICAgICAgdGFza3M6IHJPYmosXG4gICAgICAgICAgICAgICAgdG90YWxfY291bnQ6IHJlc3BvbnNlLmRhdGEudG90YWxfY291bnRcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKCkge1xuICAgICAgICAgICAgJGxvZy5lcnJvcignQVBJIGZldGNoVGFza3MgZXJyb3InKTtcbiAgICAgICAgfSk7XG4gICAgfTtcblxuICAgIHRoaXMuZmV0Y2hUYXNrID0gZnVuY3Rpb24gKHNlc3Npb24gLCB0YXNrX2lkLCBjYWxsYmFjaykge1xuICAgICAgICAkaHR0cCh7XG4gICAgICAgICAgICBtZXRob2Q6ICdHRVQnLFxuICAgICAgICAgICAgdXJsOiAnaHR0cHM6Ly9hcGktdGVzdC10YXNrLmRlY29kZWFwcHMuaW8vdGFza3MvdGFzaycsXG4gICAgICAgICAgICBwYXJhbXM6IHtzZXNzaW9uOiBzZXNzaW9uLCB0YXNrX2lkOiB0YXNrX2lkfSxcbiAgICAgICAgfSkudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzcG9uc2UpIHtcbiAgICAgICAgICAgIGNhbGxiYWNrKHJlc3BvbnNlLmRhdGEuVGFzayk7XG4gICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2soKSB7XG4gICAgICAgICAgICAkbG9nLmVycm9yKCdBUEkgZmV0Y2hQcm9qZWN0IGVycm9yJyk7XG4gICAgICAgIH0pO1xuICAgIH07XG5cbiAgICB0aGlzLmNyZWF0ZVRhc2sgPSBmdW5jdGlvbihzZXNzaW9uLCBwcm9qZWN0X2lkLCB0aXRsZSwgZGVzY3JpcHRpb24sIGNhbGxiYWNrKSB7XG4gICAgICAgICRodHRwKHtcbiAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgdXJsOiAnaHR0cHM6Ly9hcGktdGVzdC10YXNrLmRlY29kZWFwcHMuaW8vdGFza3MvdGFzaycsXG4gICAgICAgICAgICBkYXRhOiB7c2Vzc2lvbjogc2Vzc2lvbiwgUHJvamVjdDoge2lkOiBwcm9qZWN0X2lkfSwgVGFzazoge3RpdGxlOiB0aXRsZSwgZGVzY3JpcHRpb246IGRlc2NyaXB0aW9ufX0sXG4gICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICBjYWxsYmFjayhyZXNwb25zZS5kYXRhLlRhc2spO1xuICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKCkge1xuICAgICAgICAgICAgJGxvZy5lcnJvcignQVBJIGNyZWF0ZVRhc2sgZXJyb3InKTtcbiAgICAgICAgfSk7XG4gICAgfTtcblxuICAgIHRoaXMudXBkYXRlVGFzayA9IGZ1bmN0aW9uKHNlc3Npb24sIGlkLCB0aXRsZSwgZGVzY3JpcHRpb24sIGNhbGxiYWNrKSB7XG4gICAgICAgICRodHRwKHtcbiAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgdXJsOiAnaHR0cHM6Ly9hcGktdGVzdC10YXNrLmRlY29kZWFwcHMuaW8vdGFza3MvdGFzaycsXG4gICAgICAgICAgICBkYXRhOiB7c2Vzc2lvbjogc2Vzc2lvbiwgVGFzazoge2lkOiBpZCwgdGl0bGU6IHRpdGxlLCBkZXNjcmlwdGlvbjogZGVzY3JpcHRpb259fSxcbiAgICAgICAgfSkudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzcG9uc2UpIHtcbiAgICAgICAgICAgIGNhbGxiYWNrKHJlc3BvbnNlLmRhdGEpO1xuICAgICAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKCkge1xuICAgICAgICAgICAgJGxvZy5lcnJvcignQVBJIHVwZGF0ZVRhc2sgZXJyb3InKTtcbiAgICAgICAgfSk7XG4gICAgfTtcblxuICAgIHRoaXMuZGVsZXRlVGFzayA9IGZ1bmN0aW9uKHNlc3Npb24sIGlkLCBjYWxsYmFjaykge1xuICAgICAgICAkaHR0cCh7XG4gICAgICAgICAgICBtZXRob2Q6ICdERUxFVEUnLFxuICAgICAgICAgICAgdXJsOiAnaHR0cHM6Ly9hcGktdGVzdC10YXNrLmRlY29kZWFwcHMuaW8vdGFza3MvdGFzaycsXG4gICAgICAgICAgICBwYXJhbXM6IHtzZXNzaW9uOiBzZXNzaW9uLCB0YXNrX2lkOiBpZH0sXG4gICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICBjYWxsYmFjayhyZXNwb25zZS5kYXRhKTtcbiAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjaygpIHtcbiAgICAgICAgICAgICRsb2cuZXJyb3IoJ0FQSSBkZWxldGVUYXNrIGVycm9yJyk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIHRoaXMuY29tcGxpdGVUYXNrID0gZnVuY3Rpb24oc2Vzc2lvbiwgaWQsIGNhbGxiYWNrKSB7XG4gICAgICAgICRodHRwKHtcbiAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgdXJsOiAnaHR0cHM6Ly9hcGktdGVzdC10YXNrLmRlY29kZWFwcHMuaW8vdGFza3MvdGFzaycsXG4gICAgICAgICAgICBkYXRhOiB7c2Vzc2lvbjogc2Vzc2lvbiwgVGFzazoge2lkOiBpZH19LFxuICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXNwb25zZSkge1xuICAgICAgICAgICAgY2FsbGJhY2socmVzcG9uc2UuZGF0YSk7XG4gICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2soKSB7XG4gICAgICAgICAgICAkbG9nLmVycm9yKCdBUEkgZGVsZXRlVGFzayBlcnJvcicpO1xuICAgICAgICB9KTtcbiAgICB9XG59KTsiXX0=
